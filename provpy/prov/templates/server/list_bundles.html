{# Copyright (C) 2011 University of Southampton #}
{% extends "base_nav.html" %}
{% load url from future %}
{% load server_tags %}
{% block title %}PROVServer Bundles{% endblock %}
{% block content %}
	<h4 id="top" class="anchorOffset"></h4>
	<h4>Showing bundles {{ bundles.start_index }} to {{ bundles.end_index }}<br/>
	out of total {{ bundles.paginator.count }} bundle{{ bundles.paginator.count|pluralize}}.</h4>
<div class="pagination pagination-centered">
	<ul>
        <li {% if not bundles.has_previous %} class="disabled"><a><<</a>
        	{% else %}><a href="?page={{ bundles.previous_page_number }}"><<</a>{% endif %}
		{% for page in page_list %}
			{% if page == -1 %}<li><a href=?page={{forloop.counter}}>{{forloop.counter}}</a>
			{% elif page == -2 %}<li class="disabled"><a>...</a>
			{% elif page == 0 %}<li class="disabled"><a>{{forloop.counter}}</a> 
			{% endif %}</li>
		{% endfor %}
		<li {% if not bundles.has_next %} class="disabled"><a>>></a>
        	{% else %}><a href="?page={{ bundles.next_page_number }}">>></a>{% endif %}</li>
    </ul>
</div>
	<table id="top" class="table">  
        <thead>  
          <tr>
          	<th style="widht: 14%">Role</th>
            <th style="width: 50%; text-align: center;">Bundle-ID</th>  
            <th style="width: 12%"></th>
            <th style="width: 12%"></th>
            <th style="width: 12%"></th>   
          </tr>  
        </thead>  
        <tbody>
         {% for vars in bundles %}  
          <tr>   
          	<td>{% status_label vars.2 %}</td>
            <td style="text-align: center;">{{ vars.1 }}</td>  
            <td><a class="btn btn-info" type="button" href="{% url 'server.views.bundle_detail' vars.0 %}">View</a></td>  
            <td><a class="btn btn-info" type="button" href="{% url 'server.views.bundle_svg' vars.0 %}" target="_blank">SVG</a></td>
            <td>{% if vars.2 == 'o' or vars.2 == 'a' %}
            <a class="btn btn-success" type="button" href="{% url 'server.views.admin_bundle' vars.0 %}">Admin</a></td>
            {% endif %}
            {% if vars.2 == 'o' or vars.2 == 'a' or vars.2 == 'd' %} 
            <form action="{% url 'server.views.list_bundles' %}" method="post" >
            	{% csrf_token %}
            	<td><button class="btn btn-danger" type="submit" value="Delete">Delete</button></td>
            	<input type="hidden" name="delete_id" value="{{ vars.0 }}" />
            </form>
            {% else %}<td></td>{% endif %}
          </tr>  
        {% endfor %}
        </tbody>  
      </table>
{% if bundles|length > 10 %}
<div class="pagination pagination-centered">
	<ul>
        <li {% if not bundles.has_previous %} class="disabled"><a><<</a>
        	{% else %}><a href="?page={{ bundles.previous_page_number }}"><<</a>{% endif %}
		{% for page in page_list %}
			{% if page == -1 %}<li><a href=?page={{forloop.counter}}>{{forloop.counter}}</a>
			{% elif page == -2 %}<li class="disabled"><a>...</a>
			{% elif page == 0 %}<li class="disabled"><a>{{forloop.counter}}</a> 
			{% endif %}</li>
		{% endfor %}
		<li {% if not bundles.has_next %} class="disabled"><a>>></a>
        	{% else %}><a href="?page={{ bundles.next_page_number }}">>></a>{% endif %}</li>
    </ul>
</div>
{% endif %}
{% endblock %}


{% block nav_bar %}
<div class="span3">
	<h3>Filter by:</h3>
<div class="tabbable">
  <ul class="nav nav-tabs" style="margin-bottom: 0px">
    <li class="active"><a href="#name" data-toggle="tab">Name</a></li>
    <li><a href="#id" data-toggle="tab">Id</a></li>
    <li><a href="#type" data-toggle="tab">Type</a></li>
    <li><a href="#time" data-toggle="tab">Time</a></li>
    <li><a href="#any" data-toggle="tab">Any</a></li>
  </ul>
  <div class="tab-content">
    <div id="name" class="tab-pane active">
      <form class="well-form" action="{% url 'server.views.list_bundles' %}?page=1" enctype="multipart/form-data" method="post">
		{% csrf_token %}
	  	<label>Name</label>
	  	{{ form.string1 }}{{ form.string1.errors }}
  		<input type="hidden" name="choice" value="name" />
	  	<input type="submit" class="btn btn-primary" value="Search" />
	  	<a class="btn btn-primary offset1" onClick="go_to('{% url 'server.views.list_bundles' %}');">Reset</a>
	  </form>
	</div>
    <div id="id" class="tab-pane">
      <form class="well-form" action="{% url 'server.views.list_bundles' %}?page=1" enctype="multipart/form-data" method="post">
		{% csrf_token %}
		<label>Identifier</label>
	  	{{ form.string1 }}{{ form.string1.errors }}
  		<input type="hidden" name="choice" value="id" />
	  	<input type="submit" class="btn btn-primary" value="Search" />
	  	<a class="btn btn-primary offset1" onClick="go_to('{% url 'server.views.list_bundles' %}');">Reset</a>
	  </form>
    </div>
    <div id="type" class="tab-pane">
      <form class="well-form" action="{% url 'server.views.list_bundles' %}?page=1" enctype="multipart/form-data" method="post">
		{% csrf_token %}
	  	<label>Literal</label> 
	  	{{ form.string1 }}{{ form.string1.errors }}
	  	<label>Value</label> 
	  	{{ form.string2 }}{{ form.string2.errors }}
  		<input type="hidden" name="choice" value="type" />
	  	<input type="submit" class="btn btn-primary" value="Search" />
	  	<a class="btn btn-primary offset1" onClick="go_to('{% url 'server.views.list_bundles' %}');">Reset</a>
	  </form>
    </div>
    <div id="time" class="tab-pane">
      <form class="well-form" action="{% url 'server.views.list_bundles' %}?page=1" enctype="multipart/form-data" method="post">
		{% csrf_token %}
		<label>Starting time</label>
	  	{{ form.start_time }}{{ form.start_time.errors }}
	  	<label>Ending time</label>
	  	{{ form.end_time }}{{ form.end_time.errors }}
  		<input type="hidden" name="choice" value="time" />
	  	<input type="submit" class="btn btn-primary" value="Search" />
	  	<a class="btn btn-primary offset1" onClick="go_to('{% url 'server.views.list_bundles' %}');">Reset</a>
	  </form>
    </div>
    <div id="any" class="tab-pane">
      <form class="well-form" action="{% url 'server.views.list_bundles' %}?page=1" enctype="multipart/form-data" method="post">
		{% csrf_token %}
		<label>Any String</label>
	  	{{ form.string1 }}{{ form.string1.errors }}
  		<input type="hidden" name="choice" value="any" />
	  	<input type="submit" class="btn btn-primary" value="Search" />
	  	<a class="btn btn-primary offset1" onClick="go_to('{% url 'server.views.list_bundles' %}');">Reset</a>
	  </form>
    </div>
  </div><!-- /.tab-content -->
</div><!-- /.tabbable -->
{% if user.is_authenticated %}
<br/><br/>
<a class="btn btn-primary" href="{% url 'server.views.create_bundle' %}">Add New Bundle</a>
<br/><br/>
<h4><a href="#top">Back to Top</a></h4>
{% endif %}
{% endblock %}